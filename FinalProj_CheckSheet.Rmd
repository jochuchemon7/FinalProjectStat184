---
title: "R Notebook"
output: html_notebook
---

##Loading the Libararies
```{r}
# clean up workspace environment
rm(list = ls())

# all packages used for the assignment
library(mosaic)
library(tidyverse)
library(DataComputing)
library(dplyr)
library(lubridate)
```

##Purpose
**The purpose of this project is to compare how well and how much has the rate of murders with fire arms has decrease when compared to the amount of money invested and place into public services such as police, parks, events, libraries, etc... **

##Data Access
```{r}
FirearmMurdersData <- read.csv(file = file.choose(), stringsAsFactors = F)

str(FirearmMurdersData)

glimpse(FirearmMurdersData)

head(FirearmMurdersData, 10)

tail(FirearmMurdersData)

names(FirearmMurdersData)

nrow(FirearmMurdersData)

ncol(FirearmMurdersData)
```


##Modifying elements in the data
```{r}
#Getting the type elements to merge from handgun and handguns to just handgun
FirearmMurdersData$Type = as.factor(FirearmMurdersData$Type)
levels(FirearmMurdersData$Type) <- c("Handgun", "Handgun", "Rifle","Rifle", "Shotgun","Shotgun", "Unknown") 
FirearmMurdersData$Type = as.character(FirearmMurdersData$Type)
```


##Data Wrangling
```{r}
#Finding murder number per type in Pennsylvania
FirearmMurdersData %>%
  filter(State == "Pennsylvania") %>%
  group_by(State, Type) %>%
  summarise(total = sum(Total)) %>%
  arrange(desc(total))

#Finding the average number of murders per type for all the states
FirearmMurdersData %>%
  filter(State != "National") %>%
  group_by(By.Type) %>%
  summarise(average = mean(Total)) %>%
  arrange(desc(average))



#Modifying the data to have only known of firearm and by state 
KnownFireArmMurders <- FirearmMurdersData %>%
  filter(State != "National" & Type != "Unknown") 
  


#Using a descicion tree




```


```{r}
Sample <- FirearmMurdersData

Sample$Type = as.factor(Sample$Type)
levels(Sample$Type) <- c("Handgun", "Handgun", "Rifle","Rifle", "Shotgun","Shotgun", "Unknown") 
Sample$Type = as.character(Sample$Type)

  
```


##Data Visualization
```{r}
FirearmMurdersData %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_point() +
  aes(colour = State)

SpecialStates <- FirearmMurdersData %>%
  group_by(Year) %>%
  mutate(total = sum(Total)) %>%
  arrange(desc(total)) %>%
  head(7)


FirearmMurdersData %>%
  ggplot(aes(x = State, fill = Total)) +
    geom_density(adjust = 1.1, alpha = .4) +
    aes(colour = Type) +
    labs(title = "Firearm Murder Density by Type and State") + 
    theme(legend.position = "right") +
    facet_grid(Type ~ State)



KnownFireArmMurders %>%
  ggplot(aes(x = Year, y = Total.minus.Unknown)) +
  geom_point() +
  aes(colour = Type) +
  geom_lm() +
  facet_wrap(~Type, ncol=4)


PennsylvaniaMurders <- FirearmMurdersData %>%
  filter(State == "Pennsylvania")

PennsylvaniaMurders %>%
  ggplot(aes(x = Year, y = Total.minus.Unknown)) +
  geom_point() +
  aes(colour = By.Type) +
  geom_lm() +
  facet_wrap(~Type, ncol =4)
  


```



##Other Requirements
```{r}

ggplot(data=KnownFireArmMurders,aes(x=Year,y=Total.minus.Unknown))+geom_point()+aes(colour=Type)+facet_wrap(~Type,ncol=4) 
```



